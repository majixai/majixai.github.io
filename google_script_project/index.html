<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
    <title>Webhook Decompression Service</title>
  </head>
  <body>
    <h1>Webhook Decompression Service</h1>
    <p>
      This Google Apps Script provides a webhook endpoint to decompress files stored in Google Drive.
    </p>

    <h2>Endpoint URL</h2>
    <p>
      To use this service, you must first deploy this script as a web app. Once deployed, you will receive a unique URL. Send HTTP POST requests to this URL with a JSON payload.
    </p>

    <h2>JSON Payload</h2>
    <p>The POST request must contain a JSON body with the following structure:</p>
    <pre><code>{
  "fileId": "YOUR_GOOGLE_DRIVE_FILE_ID",
  "logSheetId": "OPTIONAL_GOOGLE_SHEET_ID",
  "forwardUrl": "OPTIONAL_WEBHOOK_URL"
}</code></pre>
    <ul>
      <li><code>fileId</code> (Required): The ID of the compressed file in Google Drive that you want to decompress.</li>
      <li><code>logSheetId</code> (Optional): The ID of a Google Sheet where the decompressed content will be logged. A new row with the timestamp, file ID, and content will be appended.</li>
      <li><code>forwardUrl</code> (Optional): A URL to which the decompressed content will be forwarded as a POST request.</li>
    </ul>

    <h2>Example Usage (cURL)</h2>
    <p>
      Here is an example of how to call the webhook using cURL. Replace <code>YOUR_DEPLOYMENT_URL</code> with the actual URL of your deployed web app.
    </p>
    <pre><code>curl -L -X POST 'YOUR_DEPLOYMENT_URL' \
-H 'Content-Type: application/json' \
--data-raw '{
    "fileId": "1aBcDeFgHiJkLmNoPqRsTuVwXyZ_12345",
    "logSheetId": "1aBcDeFgHiJkLmNoPqRsTuVwXyZ_54321",
    "forwardUrl": "https://your-other-webhook.com/endpoint"
}'</code></pre>

    <h2>Success Response</h2>
    <p>A successful request will return a JSON object with the decompressed content:</p>
    <pre><code>{
  "success": true,
  "fileId": "1aBcDeFgHiJkLmNoPqRsTuVwXyZ_12345",
  "content": "This is the decompressed text from the file."
}</code></pre>

    <h2>Error Response</h2>
    <p>If the request fails (e.g., due to a missing <code>fileId</code>), you will receive a JSON error message:</p>
    <pre><code>{
  "success": false,
  "error": "Missing required parameter: fileId"
}</code></pre>

  </body>
</html>
