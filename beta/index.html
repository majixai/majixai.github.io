<!DOCTYPE html>
<html lang="en">
<head>
    <title>Pornhub Viewer (Direct Fetch - EXPECTED TO FAIL)</title> {/* Changed title */}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>
        /* CSS styles remain the same */
        body { background-color: #f1f1f1; font-family: "Segoe UI", Arial, sans-serif; }
        .w3-teal, .w3-hover-teal:hover { color: #fff !important; background-color: #EE6123 !important; }
        .w3-container.header { padding: 20px; margin-bottom: 20px; }
        h1, h2, h3, h4, h5, h6 { color: #444; margin-top: 16px; margin-bottom: 8px; }
        .video-card { margin-bottom: 16px; box-shadow: 0 2px 5px 0 rgba(0,0,0,0.16),0 2px 10px 0 rgba(0,0,0,0.12); transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; background-color: #fff; overflow: hidden; }
        .video-card:hover { transform: translateY(-5px); box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19); }
        .video-card img { width: 100%; height: auto; display: block; background-color: #ddd; object-fit: cover; min-height: 100px; }
        .video-card img.thumbnail { height: 180px; object-fit: cover; }
        .video-details { padding: 8px 12px; text-align: left; }
        .video-details h4 { margin: 8px 0; font-size: 15px; font-weight: bold; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: #444; line-height: 1.3; }
        .video-details p { margin: 4px 0; font-size: 12px; color: #777; line-height: 1.4; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        #loading, #error { text-align: center; padding: 25px 15px; font-size: 18px; margin: 20px auto; display: none; max-width: 800px; border-radius: 4px; }
        #loading { color: #1e88e5; background-color: #e3f2fd; border: 1px solid #bbdefb; }
        #error { color: #d32f2f; background-color: #ffebee; border: 1px solid #ffcdd2; font-weight: bold; word-wrap: break-word; }
        .spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #09f; animation: spin 1s ease infinite; display: inline-block; vertical-align: middle; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #video-player-container { margin: 30px auto; max-width: 960px; position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background-color: #000; display: none; box-shadow: 0 4px 10px 0 rgba(0,0,0,0.2),0 4px 20px 0 rgba(0,0,0,0.19); border-radius: 4px; }
        #video-player-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        /* Style to display raw HTML if fetch succeeds (unlikely) */
        #raw-html-output {
            display: none; /* Hide by default */
            margin-top: 20px;
            padding: 15px;
            background-color: #eee;
            border: 1px solid #ccc;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap; /* Allow wrapping */
            word-break: break-all; /* Break long strings */
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body class="w3-light-grey">

<div class="w3-container w3-teal header">
  <h1>Pornhub Viewer</h1>
  {/* Removed proxy mention */}
  <p>Attempting to display videos by directly fetching specified URL.</p>
</div>

<div class="w3-container w3-margin-top">

  <!-- Video Player Container -->
   <div id="video-player-container">
       <iframe id="video-player" src="" allowfullscreen title="Video Player"></iframe>
   </div>

  <!-- Loading Indicator -->
  <div id="loading">
      <div class="spinner"></div>Attempting to fetch data...
  </div>

  <!-- Error Display Area -->
  <div id="error">
      <!-- Error message will be inserted here -->
  </div>

   <!-- Area to potentially display raw HTML (if fetch succeeds, unlikely) -->
   <pre id="raw-html-output"></pre>

  <!-- Container where videos *would* be displayed -->
  <div id="video-list" class="w3-row-padding">
      <p class="w3-center w3-text-grey" id="initial-message">Attempting direct fetch. Expecting failure due to CORS...</p>
  </div>

</div><!-- End main container -->

<!-- Embedded JavaScript -->
<script>
    document.addEventListener('DOMContentLoaded', async function() {

        console.log("DOM loaded. Initializing Viewer (Direct Fetch Mode).");

        // --- Configuration ---
        // ####################################################################
        // ## !! Direct Fetch Attempt - EXPECTED TO FAIL DUE TO CORS !!     ##
        // ## Fetching directly from a different domain like pornhub.com   ##
        // ## from browser JS is blocked by browser security policies.     ##
        // ## The target URL serves HTML, not the needed JSON/structured data.##
        // ####################################################################
        const TARGET_URL = 'https://www.pornhub.com/video/webmasterss'; // The URL you requested

        // --- DOM References ---
        const videoListDiv = document.getElementById("video-list");
        const loadingIndicator = document.getElementById("loading");
        const errorDisplay = document.getElementById("error");
        const videoPlayerContainer = document.getElementById("video-player-container");
        const videoPlayerIframe = document.getElementById("video-player");
        const initialMessage = document.getElementById("initial-message");
        const rawHtmlOutput = document.getElementById("raw-html-output"); // Added reference

        // Check essential elements exist
        if (!videoListDiv || !loadingIndicator || !errorDisplay || !videoPlayerContainer || !videoPlayerIframe || !rawHtmlOutput) {
             console.error("Fatal Error: Essential DOM elements missing.");
             document.body.innerHTML = '<div style="padding:20px;background-color:#f44336;color:white;text-align:center;"><strong>Fatal Error:</strong> Page structure incomplete.</div>';
             return;
         }

        // --- Helper Functions (UNUSED in this version as parsing HTML is too complex/unreliable) ---
        // function formatDuration(s) { ... }
        // function formatViews(v) { ... }

        // --- Core Logic ---
        async function attemptDirectFetch() {
            console.log(`Attempting DIRECT fetch from: ${TARGET_URL}`);
            if (initialMessage) initialMessage.style.display = 'none';
            showLoading();
            hideError();
            hideVideoPlayer();
            videoListDiv.innerHTML = ""; // Clear video list area
            rawHtmlOutput.style.display = 'none'; // Hide raw output area
            rawHtmlOutput.textContent = ''; // Clear previous raw output

            try {
                 // No AbortController needed for this example as failure is expected quickly
                console.log("Making fetch request...");
                // Attempt the fetch - THIS IS THE STEP EXPECTED TO BE BLOCKED BY CORS
                const response = await fetch(TARGET_URL, {
                    mode: 'cors', // Explicitly asking for CORS mode (but server must allow it)
                    redirect: 'follow' // Follow redirects if any
                 });

                console.log(`Fetch response status: ${response.status} (${response.statusText})`);

                // Check if the response was successful (status 200-299)
                // Even if status is OK, CORS might have made the response "opaque",
                // meaning we can't access its content. However, a direct CORS block
                // usually throws a TypeError before this point.
                if (!response.ok) {
                    throw new Error(`Server responded with status ${response.status} (${response.statusText}).`);
                }

                // If fetch somehow succeeded (EXTREMELY UNLIKELY due to CORS), get the HTML text
                console.log("Fetch response received, attempting to read HTML text...");
                const htmlText = await response.text();
                console.log("Successfully fetched HTML text (CORS likely not enforced or bypassed - highly unusual).");

                // **PROBLEM:** Now we have raw HTML. Parsing this reliably to find
                // video titles, *embed* URLs (not just view URLs), thumbnails, etc.
                // in the frontend is very difficult and breaks easily if Pornhub changes layout.
                // The previous code expected structured JSON data.
                // Displaying the raw HTML instead of processing it:
                showRawHtml(htmlText);
                showError("Fetch succeeded (unexpectedly!), but received HTML page, not structured video data. Cannot display video cards. Raw HTML shown below.");


            } catch (error) {
                console.error("Fetch failed:", error);
                let userMsg;

                // Check for the typical CORS error (often a TypeError)
                if (error instanceof TypeError) { // Network errors, including CORS failures
                    userMsg = `Direct fetch failed. This is expected due to browser CORS security policy blocking requests to '${TARGET_URL}'. Check the browser console (F12) for CORS errors.`;
                 } else {
                    userMsg = `An unexpected error occurred: ${error.message}`;
                }

                showError(userMsg + " A server-side proxy is required to bypass these browser restrictions.");
                // Keep the initial message area showing the failure context
                videoListDiv.innerHTML = `<p class="w3-center w3-text-red"><strong>Direct Fetch Failed (Expected):</strong> ${userMsg}</p>`;

            } finally {
                 hideLoading();
                 console.log("attemptDirectFetch finished.");
            }
        }

        // Function to display videos - WILL NOT BE CALLED in this version
        // function displayVideos(videos) { ... }

        // Function to load video in player - Unlikely to be called
        function loadVideoInPlayer(embedUrl) {
             if (!embedUrl) { showError("Cannot play: Embed URL missing."); return; }
             console.log("Loading player:", embedUrl);
             videoPlayerIframe.src = embedUrl;
             videoPlayerContainer.style.display = 'block';
             videoPlayerContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
         }

        // Function to hide player
        function hideVideoPlayer() {
             if (videoPlayerContainer) videoPlayerContainer.style.display = 'none';
             if (videoPlayerIframe) videoPlayerIframe.src = '';
         }

         // Function to display raw HTML
         function showRawHtml(htmlContent) {
             rawHtmlOutput.textContent = htmlContent;
             rawHtmlOutput.style.display = 'block';
         }

        // --- UI Update Functions ---
        function showLoading() { loadingIndicator.style.display = 'block'; hideError(); }
        function hideLoading() { loadingIndicator.style.display = 'none'; }
        function showError(message) {
            const cleanMessage = message.replace(/</g, "<").replace(/>/g, ">");
            errorDisplay.innerHTML = `<strong>Error:</strong> ${cleanMessage}`;
            errorDisplay.style.display = 'block';
            hideLoading();
            console.error("User Error Displayed:", message);
         }
        function hideError() { errorDisplay.style.display = 'none'; errorDisplay.textContent = ''; }

         // --- Initialization ---
        attemptDirectFetch(); // Start the direct fetch attempt
        console.log("Viewer Initialized (Direct Fetch Mode). Waiting for fetch attempt.");

    });
</script>

</body>
</html>
